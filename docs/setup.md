# Development Setup

This guide provides instructions on how to set up the development environment for this Flask application.

## 1. Prerequisites
    - Python (3.9+ recommended)
    - pip (Python package installer, usually comes with Python)
    - Git (Version control system)
    - (Optional) If you don't have Python installed, you can download it from [python.org](https://www.python.org/downloads/).

## 2. Getting the Code
    - Clone the repository from your source (e.g., GitHub):
      ```bash
      git clone <repository-url>
      ```
    - Navigate into the project directory:
      ```bash
      cd <project-name>
      ```

## 3. Virtual Environment
    - It is highly recommended to use a virtual environment to manage project-specific dependencies.
    - Creating a virtual environment:
        - macOS/Linux:
          ```bash
          python3 -m venv venv
          ```
        - Windows:
          ```bash
          python -m venv venv
          ```
    - Activating the virtual environment:
        - macOS/Linux:
          ```bash
          source venv/bin/activate
          ```
        - Windows:
          ```bash
          .\venv\Scripts\activate
          ```
      (You should see `(venv)` at the beginning of your command prompt.)

## 4. Installing Dependencies
    - Ensure your pip is up-to-date:
      ```bash
      python -m pip install --upgrade pip
      ```
    - Install project requirements:
      ```bash
      pip install -r requirements.txt
      ```
    - Install development dependencies (for linting, formatting, testing):
      ```bash
      pip install flake8 black isort pytest pytest-cov
      ```
      (Note: These might be part of a `requirements-dev.txt` in some projects, but here we list them for explicit installation if not included in the main `requirements.txt`.)

## 5. Environment Configuration
    - Flask uses environment variables for configuration. These can be set in a `.flaskenv` file in the project root, which is automatically loaded by Flask if `python-dotenv` is installed (it's often a Flask dependency or can be installed separately).
    - Create a file named `.flaskenv` in the project root directory.
    - Add the following required variables:
        ```env
        FLASK_APP=src.app
        FLASK_DEBUG=1
        SECRET_KEY=your_very_strong_and_unique_secret_key_here
        ```
      **Important**: `FLASK_DEBUG=1` enables debug mode and the auto-reloader. For `SECRET_KEY`, generate a strong unique key for your local development. While a simple key might work for initial local setup, avoid using weak or default keys for any extended period or if the app becomes accessible.

## 6. Database Setup
    - The application uses SQLite for its database. The database schema needs to be initialized before running the app for the first time.
    - Run the database initialization command from your activated virtual environment in the project root:
      ```bash
      flask init-db
      ```
    - This command (defined in `src/app.py` but now calls logic from `src/core/database.py`) initializes the database. This includes:
        - Creating the necessary database tables (e.g., `user` table with its specific schema including an `updated_at` trigger).
        - Enabling Write-Ahead Logging (WAL) mode for the database.
    - The database file, named `app_database.db`, will be created in the `instance` folder within your project directory (e.g., `<project-name>/instance/app_database.db`). The `instance` folder is automatically created by Flask if it doesn't exist when `instance_relative_config=True` is used (or by the database connection logic if necessary).

## 7. Running the Development Server
    - Once dependencies are installed and the database is initialized, you can run the Flask development server:
      ```bash
      flask run
      ```
    - You should see output similar to:
      ```
       * Serving Flask app 'src.app'
       * Debug mode: on
       * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
       * Restarting with stat
       * Debugger is active!
       * Debugger PIN: ...
      ```
    - Open your web browser and navigate to `http://127.0.0.1:5000/` to access the application.

## 8. Running Tests
    - To ensure the application is working correctly, run the test suite.
    - Command to run all unit and integration tests:
      ```bash
      pytest
      ```
    - Command to run tests with code coverage analysis for the `src` directory:
      ```bash
      pytest --cov=src
      ```
    - Coverage reports are displayed in the terminal. If an HTML report is configured (e.g., via `pytest.ini` or command-line options like `--cov-report=html`), it will typically be found in an `htmlcov/` directory. An XML report (`coverage.xml`) is also generated by the CI workflow and can be configured for local use too.

## 9. Code Quality Checks (Optional but Recommended)
    - Maintaining code quality is important. You can run these checks locally:
    - Running linters (Flake8):
      ```bash
      flake8 src tests
      ```
    - Checking formatting (Black and isort):
      ```bash
      black --check src tests
      isort --check-only src tests
      ```
    - To automatically apply formatting:
      ```bash
      black src tests
      isort src tests
      ```
    - (Optional) If a `.pre-commit-config.yaml` file is present in the project, you can set up pre-commit hooks to automate these checks before each commit:
      ```bash
      # Install pre-commit if you haven't: pip install pre-commit
      pre-commit install
      ```
      This will run the defined hooks automatically when you `git commit`.
